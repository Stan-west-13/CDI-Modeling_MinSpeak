---
title: "Standardized Network Analysis"
author: "Stanley West"
format: 
  revealjs:
    scrollable: true
    smaller: true
editor: 
  markdown: 
    wrap: 72
---

# The Data {.smaller .scrollable}

-   Up to this point, individual lexical networks have been constructed
    for each child, with edges drawn according to forward association
    (i.e., cue -\> response) relationships.
    -   Network statistics including in-degree (number of incoming
        connections), global clustering coefficient (ratio of number of
        triangles to the number of possible triangles), mean average
        shortest path length (ASPL, average edge distance between nodes)
        were computed for each child.
-   These values were standardized according to 1,000 individualized
    pseudo-random acquisition networks for each child where the number
    of nodes as well as the number of nouns, verbs, and other words were
    matched to the child's vocabulary.

```{r,echo = FALSE}
library(tidyverse)
library(ggplot2)
library(purrr)
library(MatchIt)
d_netstats <- read_rds("data/all_Netstats_z_meta.rds") %>%
  mutate(metric_plot = factor(metric, 
                              levels = c("indegreemed","indegreeavg","clustcoef","meandist"),
                              labels = c("Median_Indegree", "Average_Indegree","Clustering_Coefficient","Mean Distance")),
         group = factor(group, levels = c("yng", "mdl", "old")))

matched_pps <- read_rds("data/matched_groups_single_timepoint.rds")



```

## Overall Statistic Trajectories Over Vocabulary Size and Age {.smaller .scrollable}

```{r}

ggplot(d_netstats %>% 
         filter(origin == "truenet"&stat == "truestat"), aes(x = nProduced, y = value))+
  geom_point()+
  geom_smooth(method = "loess")+
  facet_grid(~metric_plot,scales = "free_y")+
  theme_bw()+
  labs(title = "True Scores Across Vocabuary")

ggplot(d_netstats %>% 
         filter(origin == "RAN"&stat == "mean"), aes(x = nProduced, y = value))+
  geom_point()+
  geom_smooth(method = "loess")+
  facet_grid(~metric_plot)+
  theme_bw()+
  labs(title = "RAN Scores Across Vocabuary")

ggplot(d_netstats, aes(x = nProduced, y = z))+
  geom_point()+
  geom_smooth(method = "loess")+
  facet_grid(~metric_plot)+
  theme_bw()+
  labs(title = "Standardized Scores across vocabuary")
```

## Plotting unmatched statistic distributions over production {.smaller .scrollable}

-   Distributions across the unmatched samples look similar, especially
    at smaller vocabularies.
-   However, this is still collapsed across forms.

```{r}

ggplot(d_netstats %>% 
         filter(form == "WS"), aes(x = nProduced, y = z, color = group))+
  geom_point() +
  facet_grid(~metric_plot)+
  geom_smooth(method = "loess")+
  theme_bw()+
  labs(title = "Unmatched Statistic Distrubution Over Production - Words & Sentences",
       x = "Productive Vocabulary",
       y = "Z-scored Network Statistic")

ggplot(d_netstats %>% 
         filter(form == "WG"), aes(x = nProduced, y = z, color = group))+
  geom_point() +
  facet_grid(~metric_plot)+
  geom_smooth(method = "loess")+
  theme_bw()+
  labs(title = "Unmatched Statistic Distrubution Over Production - Words & Gestures",
       x = "Productive Vocabulary",
       y = "Z-scored Network Statistic")



ggplot(d_netstats , aes(x = group, y = z, color = group))+
  geom_violin() +
  geom_boxplot(width = 0.2, fill = "lightgrey")+
  facet_grid(~metric_plot)+
  theme_bw()+
  labs(title = "Unmatched Statistic Boxplots Over Group ",
       x = "Group",
       y = "Z-scored Network Statistic")

```

# Words and Gestures Analyses Only

-   Youngest administration

-   Only allowing networks of size 3 - 349 words.

-   Collapsing the middle-aged group (48 - 70 months old) and the
    youngest group (16 - 42 months) to create a non-minimally speaking
    and a minimally speaking group.

## Filtering to Words and Gestures

```{r,echo = TRUE}
d_WG <- d_netstats %>%
  filter(form == "WG",
         nProduced >= 3 & nProduced <= 349) %>%
  group_by(subjectkey) %>%
  slice_min(interview_age,n = 1) %>%
  mutate(group_two = as.factor(ifelse(group == "yng"|group =="mdl", "non_minspeak","minspeak")))

d_WG %>%
  select(subjectkey,interview_age,nProduced,group_two) %>%
  unique() %>%
  group_by(group_two) %>%
  summarize(n = n(),
            mean_age = mean(interview_age),
            mean_produced = mean(nProduced),
            sd_age = sd(interview_age),
            sd_produced = sd(nProduced)) %>%
  as.data.frame()
  


```

## Match groups on vocabulary size

```{r}

match_lst <- d_WG %>%
  select(subjectkey, interview_age,nProduced, group_two) %>%
  unique() %>%
  matchit(group_two ~ nProduced, data = ., method = "optimal", distance = "glm")

summary(match_lst)

plot(match_lst, type = "density", interactive = TRUE)

matched_df <- d_WG %>%
  filter(subjectkey %in% match.data(match_lst)$subjectkey)

t.test(unique(matched_df$nProduced[matched_df$group_two == "non_minspeak"]),
       unique(matched_df$nProduced[matched_df$group_two == "minspeak"]))
```
